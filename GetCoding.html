<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Start Guide for LewanSoul-Lobot-HiWonder xArm Python Package</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0 auto;
            max-width: 800px;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1, h2, h3 {
            color: #333;
        }
        h1 {
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        h2 {
            margin-top: 20px;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }
        h3 {
            margin-top: 15px;
        }
        p {
            margin: 10px 0;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid #ddd;
        }
        pre code {
            background-color: transparent;
            padding: 0;
        }
        a {
            color: #007bff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        ul, ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        li {
            margin: 5px 0;
        }
        .note {
            background-color: #e7f3fe;
            border-left: 4px solid #2196F3;
            padding: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Quick Start Guide for LewanSoul-Lobot-HiWonder xArm Python Package</h1>
    <p>This guide provides a comprehensive introduction to using the <a href="https://pypi.org/project/xarm/">xarm Python package</a> to control the LewanSoul-Lobot-HiWonder xArm, a 6-DOF desktop robotic arm (e.g., xArm 1S). The guide is divided into three parts: <strong>Basic Setup and Testing</strong>, <strong>In-Depth Programming and Classes</strong>, and <strong>Advanced Coding</strong>. It leverages the <a href="https://github.com/ccourson/xArmServoController">xArmServoController</a> library and related resources.</p>

    <h2>Part 1: Basic Setup and Testing</h2>
    <p>This section covers installing the <code>xarm</code> package, setting up the environment, and performing basic tests to control the Hiwonder xArm.</p>

    <h3>Installation</h3>
    <ol>
        <li><strong>Install Python</strong>: Ensure Python 3.6+ is installed. Download from <a href="https://www.python.org/">python.org</a> if needed.</li>
        <li><strong>Install the xArm Package</strong>:
            <pre><code>py -m pip install xarm</code></pre>
            This installs version 0.2 of the <code>xarm</code> package for controlling the arm’s LX-15D servos.
        </li>
        <li><strong>Verify Installation</strong>:
            <pre><code>py -m pip show xarm</code></pre>
            Test the import in Python:
            <pre><code>import xarm
print(xarm.__version__)  # Should print 0.2</code></pre>
        </li>
    </ol>

    <h3>Hardware Setup</h3>
    <ol>
        <li><strong>Connect the xArm</strong>:
            <ul>
                <li>Connect the arm’s control board to your computer or Raspberry Pi via USB (micro-USB to USB port).</li>
                <li>Alternatively, use the 4-pin secondary development interface (5V, GND, RX, TX) for serial communication, but USB is standard.</li>
                <li>Power the arm with a 7.5V 6A DC power supply (per xArm 1S specs).</li>
            </ul>
        </li>
        <li><strong>Driver Setup</strong>:
            <ul>
                <li>On Windows, install the CH340 driver if USB connection fails (<a href="https://www.hiwonder.com.cn/store/learn/42.html">Hiwonder Tutorials</a>).</li>
                <li>On Linux, ensure USB port permissions:
                    <pre><code>sudo chmod a+rw /dev/ttyUSB0</code></pre>
                    Check the port with <code>sudo dmesg</code> (e.g., <code>/dev/ttyUSB0</code>).
                </li>
            </ul>
        </li>
    </ol>

    <h3>Basic Testing</h3>
    <ol>
        <li><strong>Initialize the Controller</strong>:
            <pre><code>import xarm
arm = xarm.Controller('USB')  # Use 'USB' for USB connection</code></pre>
        </li>
        <li><strong>Move a Servo</strong>:
            Move the gripper (servo ID 1):
            <pre><code>arm.setPosition(1, 500, 1000, True)  # Servo 1, position 500 (mid-range), 1000ms, wait=True</code></pre>
            Positions range from 0 to 1000 (~0–240 degrees).
        </li>
        <li><strong>Read Servo Position</strong>:
            <pre><code>pos = arm.getPosition(1)
print(f"Servo 1 position: {pos}")</code></pre>
        </li>
        <li><strong>Turn Off Servo</strong>:
            <pre><code>arm.servoOff(1)</code></pre>
        </li>
    </ol>

    <div class="note">
        <p><strong>Testing Notes</strong>:</p>
        <ul>
            <li>Use a virtual environment to avoid conflicts:
                <pre><code>python -m venv xarm_env
source xarm_env/bin/activate  # Windows: xarm_env\Scripts\activate
py -m pip install xarm</code></pre>
            </li>
            <li><strong>Safety</strong>: Test small movements to avoid servo strain. Ensure the arm is stable.</li>
            <li><strong>Troubleshooting</strong>: If the arm beeps or fails to connect, verify the CH340 driver or contact <a href="mailto:support@hiwonder.com">Hiwonder support</a>.</li>
        </ul>
    </div>

    <h2>Part 2: In-Depth Programming and Classes</h2>
    <p>This section explores the <code>xarm</code> package’s <code>Controller</code> class and methods for complex servo movements.</p>

    <h3>Understanding the Controller Class</h3>
    <p>The <code>xarm.Controller</code> class controls the xArm’s six LX-15D servos (5 joints, 1 gripper).</p>
    <ul>
        <li><strong>Initialization</strong>:
            <pre><code>import xarm
arm = xarm.Controller('USB')</code></pre>
        </li>
        <li><strong>Key Methods</strong>:
            <ul>
                <li><code>setPosition(servo_id, position, time, wait)</code>: Move a servo to a position (0–1000) over <code>time</code> (ms).</li>
                <li><code>getPosition(servo_id, degrees=False)</code>: Read position (0–1000 or degrees if <code>degrees=True</code>).</li>
                <li><code>servoOff(servo_id)</code>: Disable a servo.</li>
                <li><code>setPositions(positions, time, wait)</code>: Move multiple servos (implied in examples).</li>
            </ul>
        </li>
    </ul>

    <h3>Programming Servo Sequences</h3>
    <ol>
        <li><strong>Capture Positions</strong>:
            Manually move the arm and record positions:
            <pre><code>position = []
for i in range(1, 7):  # Servos 1–6
    position.append(arm.getPosition(i))
print(position)  # Example: [277, 497, 495, 545, 499, 489]</code></pre>
        </li>
        <li><strong>Execute a Sequence</strong>:
            Move through predefined positions:
            <pre><code>import time
arm_sequence = [
    [277, 497, 495, 545, 499, 489],  # Home, claw open
    [277, 497, 200, 835, 432, 498],  # Lower arm
    [699],                           # Close gripper
    [999.9, 497, 495, 545, 499, 489] # Back to home
]
for positions in arm_sequence:
    if len(positions) == 1:
        arm.setPosition(1, positions[0], 1000, True)
    else:
        for i, pos in enumerate(positions, 1):
            if pos != 999.9:
                arm.setPosition(i, pos, 1000, True)
    time.sleep(0.5)</code></pre>
        </li>
    </ol>

    <h3>Gripper Control</h3>
    <p>Control the gripper (servo ID 1):</p>
    <pre><code>arm.setPosition(1, 277, 1000, True)  # Open
arm.setPosition(1, 699, 1000, True)  # Close
arm.servoOff(1)                     # Release</code></pre>

    <h3>Example: Simple Pick-and-Place</h3>
    <pre><code>import xarm
from time import sleep

arm = xarm.Controller('USB')
# Home position
arm.setPosition(1, 277, 1000, True)  # Open gripper
arm.setPosition(2, 497, 1000, True)
arm.setPosition(3, 495, 1000, True)
arm.setPosition(4, 545, 1000, True)
arm.setPosition(5, 499, 1000, True)
arm.setPosition(6, 489, 1000, True)
sleep(1)
# Lower to pick
arm.setPosition(3, 200, 1000, True)
arm.setPosition(4, 835, 1000, True)
arm.setPosition(5, 432, 1000, True)
sleep(1)
# Grab
arm.setPosition(1, 699, 1000, True)
sleep(0.5)
# Lift
arm.setPosition(3, 495, 1000, True)
arm.setPosition(4, 545, 1000, True)
arm.setPosition(5, 499, 1000, True)
sleep(1)
# Release
arm.setPosition(1, 277, 1000, True)
arm.servoOff(1)</code></pre>

    <h3>Best Practices</h3>
    <ul>
        <li>Use <code>time.sleep()</code> for smooth transitions.</li>
        <li>Manually calibrate positions for accuracy (no built-in kinematics).</li>
        <li>Verify movements with <code>getPosition</code>.</li>
    </ul>

    <h2>Part 3: Advanced Coding</h2>
    <p>This section covers advanced features, including ROS integration, custom servo control, and sensor extensions.</p>

    <h3>Advanced Servo Control</h3>
    <ol>
        <li><strong>Fine-Tuning</strong>:
            <pre><code>current_pos = arm.getPosition(1)
arm.setPosition(1, current_pos + 50, 500, True)  # Incremental</code></pre>
        </li>
        <li><strong>Action Groups</strong>:
            <p>Use Hiwonder’s PC software to record actions, then trigger via Python (if firmware supports). Check the <a href="https://www.dropbox.com/sh/b3v81sb9nwir">protocol</a>.</p>
        </li>
    </ol>

    <h3>ROS Integration</h3>
    <p>Use the <a href="https://github.com/adeguet1/lewansoul-xarm">lewansoul-xarm</a> package for ROS (Melodic recommended).</p>
    <ul>
        <li><strong>Setup</strong> (Linux):
            <pre><code>sudo apt install ros-melodic-joint-state-publisher-gui
git clone https://github.com/adeguet1/lewansoul-xarm
cd lewansoul-xarm
catkin_make</code></pre>
        </li>
        <li><strong>Calibrate</strong>:
            <pre><code>rostopic pub -1 /xArm/disable std_msgs/Empty "{}"
# Move to zero position
rostopic pub -1 /xArm/calibrate std_msgs/Empty "{}"</code></pre>
        </li>
        <li><strong>Control</strong>:
            <pre><code>import math
import lewansoul_xarm
c = lewansoul_xarm.controller()
a = c.add_arm(5, 4, 3)  # Joint servo IDs
a.home()
p = a.measured_jp()
p[0] += math.pi / 4.0  # Move joint 0 by 45°
a.move_jp(p)</code></pre>
        </li>
        <li><strong>Notes</strong>:
            <ul>
                <li>Uses HID interface (<code>/dev/hidraw3</code>).</li>
                <li>Set udev rules:
                    <pre><code>echo 'SUBSYSTEM=="hidraw", ATTRS{product}=="LOBOT", GROUP="dialout", MODE="0660"' | sudo tee /etc/udev/rules.d/80-usb-xarm.rules
sudo udevadm control --reload-rules
sudo udevadm trigger</code></pre>
                </li>
                <li>Disable <code>fwupd</code> if HID issues occur:
                    <pre><code>sudo service fwupd stop</code></pre>
                </li>
            </ul>
        </li>
    </ul>

    <h3>Sensor Integration</h3>
    <p>Use Hiwonder’s sensor kit (e.g., ultrasonic) for tasks like object detection.</p>
    <ul>
        <li><strong>Example</strong> (pseudo-code):
            <pre><code>import xarm
from sensor_module import UltrasonicSensor
arm = xarm.Controller('USB')
sensor = UltrasonicSensor('/dev/ttyUSB1')
while True:
    distance = sensor.read_distance()
    if distance < 10:  # Object within 10cm
        arm.setPosition(1, 699, 1000, True)  # Close gripper
        break
    time.sleep(0.1)</code></pre>
        </li>
        <li><strong>Wiring</strong>: Connect sensors to the controller’s 4-pin interfaces (xArm 2.0 compatible, may need推迟require custom code for xArm 1S).</li>
    </ul>

    <h3>Example: Vision-Guided Pick-and-Place</h3>
    <p>Integrate with OpenCV for vision control:</p>
    <pre><code>import xarm
import cv2
import numpy as np
from time import sleep

arm = xarm.Controller('USB')
cap = cv2.VideoCapture(0)
arm.setPosition(1, 277, 1000, True)  # Open gripper
arm.setPosition(2, 497, 1000, True)  # Home
# ... (set other servos)
while True:
    ret, frame = cap.read()
    hsv = cv2.cvtColor(frame, cv2.COLOR_BGR2HSV)
    mask = cv2.inRange(hsv, np.array([0, 120, 70]), np.array([10, 255, 255]))
    contours, _ = cv2.findContours(mask, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
    if contours:
        c = max(contours, key=cv2.contourArea)
        x, y, w, h = cv2.boundingRect(c)
        servo_pos = 497 + (x - 320) * 0.1  # Map to servo
        arm.setPosition(2, servo_pos, 1000, True)
        arm.setPosition(3, 200, 1000, True)
        arm.setPosition(1, 699, 1000, True)  # Grab
        sleep(0.5)
        arm.setPosition(3, 495, 1000, True)  # Lift
        break
    cv2.imshow('Frame', frame)
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break
cap.release()
cv2.destroyAllWindows()
arm.servoOff(1)</code></pre>

    <h3>Advanced Tips</h3>
    <ul>
        <li><strong>Custom Protocols</strong>: Use the <a href="https://www.dropbox.com/sh/b3v81sb9nwir">LewanSoul Servo Protocol</a> with <code>pylx16a</code> for low-level control.</li>
        <li><strong>Arduino</strong>: Control via Arduino R4 WiFi (<a href="https://drive.google.com/drive/folders/1LM1oO0xFugVmytikRXbtgUGVc8deX7zT">Hiwonder protocol</a>).</li>
        <li><strong>Multithreading</strong>: Use <code>threading</code> for sensor feedback, ensuring thread-safe servo commands.</li>
        <li><strong>Firmware</strong>: Disable <code>fwupd</code> if HID fails; check <code>/var/log/syslog</code>.</li>
    </ul>

    <h3>Learning Resources</h3>
    <ul>
        <li><strong>GitHub</strong>:
            <ul>
                <li><a href="https://github.com/ccourson/xArmServoController">xArmServoController</a></li>
                <li><a href="https://github.com/DuaneOne/Hiwonder-LewanSoul-xArm-1S-Python-for-RPi-examples">Hiwonder-LewanSoul-xArm-1S-Python-for-RPi-examples</a></li>
                <li><a href="https://github.com/adeguet1/lewansoul-xarm">lewansoul-xarm</a> (ROS)</li>
            </ul>
        </li>
        <li><strong>Hiwonder Tutorials</strong>: <a href="https://www.hiwonder.com.cn/store/learn/42.html">Hiwonder Learn</a></li>
        <li><strong>Community</strong>: <a href="https://www.facebook.com/xarmenthusiast">LewanSoul-xArm Enthusiast</a></li>
    </ul>

    <div class="note">
        <p><strong>Notes</strong>:</p>
        <ul>
            <li><strong>Safety</strong>: The xArm is 5-DOF (plus gripper), limiting reachability. Test carefully to avoid servo damage.</li>
            <li><strong>Dependencies</strong>: Minimal for <code>xarm</code>, but ROS/vision tasks need <code>opencv-python</code>, <code>rospy</code>, etc.</li>
            <li><strong>Limitations</strong>: No built-in kinematics or collision detection; use ROS for advanced control.</li>
            <li><strong>Naming</strong>: Sold as LewanSoul, Lobot, or Hiwonder xArm (e.g., xArm 1S). This guide targets this hardware, not UFACTORY’s xArm.</li>
        </ul>
        <p>For further assistance, explore the cited resources or contact <a href="mailto:support@hiwonder.com">Hiwonder support</a>.</p>
    </div>
</body>
</html>
